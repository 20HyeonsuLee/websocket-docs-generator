---
asyncapi: "3.0.0"
info:
  title: "coffee-shout wesocket docs"
  version: "2025-08-30T16:34:47.949303"
  description: "커피빵에서 사용되는 웹소켓 명세서"
channels:
  /app/room/{joinCode}/minigame/command:
    messages:
      MiniGameMessage:
        $ref: "#/components/messages/MiniGameMessage"
  /app/room/{joinCode}/spin-roulette:
    messages:
      RouletteSpinMessage:
        $ref: "#/components/messages/RouletteSpinMessage"
  /app/room/{joinCode}/update-players: {}
  /app/room/{joinCode}/update-minigames:
    messages:
      MiniGameSelectMessage:
        $ref: "#/components/messages/MiniGameSelectMessage"
  /app/room/{joinCode}/update-menus:
    messages:
      MenuChangeMessage:
        $ref: "#/components/messages/MenuChangeMessage"
  /app/room/{joinCode}/get-probabilities: {}
  /app/room/{joinCode}/update-ready:
    messages:
      ReadyChangeMessage:
        $ref: "#/components/messages/ReadyChangeMessage"
  /topic/room/{joinCode}/winner:
    messages:
      WinnerResponse:
        $ref: "#/components/messages/WinnerResponse"
  /topic/room/{joinCode}/round:
    messages:
      MiniGameStartMessage:
        $ref: "#/components/messages/MiniGameStartMessage"
  /topic/room/{joinCode}:
    messages:
      PlayerResponse:
        $ref: "#/components/messages/PlayerResponse"
  /topic/room/{joinCode}/minigame:
    messages:
      MiniGameType:
        $ref: "#/components/messages/MiniGameType"
  /topic/room/{joinCode}/gameState:
    messages:
      MiniGameStateMessage:
        $ref: "#/components/messages/MiniGameStateMessage"
  /topic/room/{joinCode}/roulette:
    messages:
      ProbabilityResponse:
        $ref: "#/components/messages/ProbabilityResponse"
operations:
  /room/{joinCode}/spin-roulette:
    action: "send"
    channel:
      $ref: "#/channels/~1app~1room~1{joinCode}~1spin-roulette"
    summary: "summary"
    description: "description"
    messages:
      - $ref: "#/components/messages/RouletteSpinMessage"
    reply:
      channel:
        $ref: "#/channels/~1topic~1room~1{joinCode}~1winner"
      messages:
        - $ref: "#/components/messages/WinnerResponse"
  /room/{joinCode}/update-players:
    action: "send"
    channel:
      $ref: "#/channels/~1app~1room~1{joinCode}~1update-players"
    summary: "summary"
    description: "description"
    messages: []
    reply:
      channel:
        $ref: "#/channels/~1topic~1room~1{joinCode}"
      messages:
        - $ref: "#/components/messages/PlayerResponse"
  /room/{joinCode}/update-minigames:
    action: "send"
    channel:
      $ref: "#/channels/~1app~1room~1{joinCode}~1update-minigames"
    summary: "summary"
    description: "description"
    messages:
      - $ref: "#/components/messages/MiniGameSelectMessage"
    reply:
      channel:
        $ref: "#/channels/~1topic~1room~1{joinCode}~1minigame"
      messages:
        - $ref: "#/components/messages/MiniGameType"
  /room/{joinCode}/update-menus:
    action: "send"
    channel:
      $ref: "#/channels/~1app~1room~1{joinCode}~1update-menus"
    summary: "summary"
    description: "description"
    messages:
      - $ref: "#/components/messages/MenuChangeMessage"
    reply:
      channel:
        $ref: "#/channels/~1topic~1room~1{joinCode}"
      messages:
        - $ref: "#/components/messages/PlayerResponse"
  /room/{joinCode}/get-probabilities:
    action: "send"
    channel:
      $ref: "#/channels/~1app~1room~1{joinCode}~1get-probabilities"
    summary: "summary"
    description: "description"
    messages: []
    reply:
      channel:
        $ref: "#/channels/~1topic~1room~1{joinCode}~1roulette"
      messages:
        - $ref: "#/components/messages/ProbabilityResponse"
  /room/{joinCode}/update-ready:
    action: "send"
    channel:
      $ref: "#/channels/~1app~1room~1{joinCode}~1update-ready"
    summary: "summary"
    description: "description"
    messages:
      - $ref: "#/components/messages/ReadyChangeMessage"
    reply:
      channel:
        $ref: "#/channels/~1topic~1room~1{joinCode}"
      messages:
        - $ref: "#/components/messages/PlayerResponse"
  /room/{joinCode}/round:
    action: "receive"
    channel:
      $ref: "#/channels/~1topic~1room~1{joinCode}~1round"
    summary: "summary"
    description: "description"
    messages:
      - $ref: "#/components/messages/MiniGameStartMessage"
  /room/{joinCode}/gameState:
    action: "receive"
    channel:
      $ref: "#/channels/~1topic~1room~1{joinCode}~1gameState"
    summary: "summary"
    description: "description"
    messages:
      - $ref: "#/components/messages/MiniGameStateMessage"
components:
  messages:
    MiniGameMessage:
      payload:
        $ref: "#/components/schemas/MiniGameMessage"
    MiniGameStateMessage:
      payload:
        $ref: "#/components/schemas/MiniGameStateMessage"
    MiniGameStartMessage:
      payload:
        $ref: "#/components/schemas/MiniGameStartMessage"
    ReadyChangeMessage:
      payload:
        $ref: "#/components/schemas/ReadyChangeMessage"
    WinnerResponse:
      payload:
        $ref: "#/components/schemas/WinnerResponse"
    MiniGameType:
      payload:
        $ref: "#/components/schemas/MiniGameType"
    MenuChangeMessage:
      payload:
        $ref: "#/components/schemas/MenuChangeMessage"
    MiniGameSelectMessage:
      payload:
        $ref: "#/components/schemas/MiniGameSelectMessage"
    PlayerResponse:
      payload:
        $ref: "#/components/schemas/PlayerResponse"
    RouletteSpinMessage:
      payload:
        $ref: "#/components/schemas/RouletteSpinMessage"
    ProbabilityResponse:
      payload:
        $ref: "#/components/schemas/ProbabilityResponse"
  schemas:
    WinnerResponse:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        colorIndex:
          type: "integer"
        playerName:
          type: "string"
        randomAngle:
          type: "integer"
    MiniGameStartMessage:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        miniGameType:
          type: "string"
          const: "CARD_GAME"
    PlayerResponse:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        colorIndex:
          type: "integer"
        isReady:
          type: "boolean"
        menuResponse:
          type: "object"
          properties:
            id:
              type: "integer"
            menuType:
              type: "string"
              enum:
                - "COFFEE"
                - "ADE"
                - "SMOOTHIE"
                - "FRAPPUCCINO"
                - "ETC"
            name:
              type: "string"
        playerName:
          type: "string"
        playerType:
          type: "string"
          enum:
            - "HOST"
            - "GUEST"
    MiniGameType:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "string"
      const: "CARD_GAME"
    MiniGameStateMessage:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        allSelected:
          type: "boolean"
        cardGameState:
          type: "string"
        cardInfoMessages:
          type: "array"
          items:
            type: "object"
            properties:
              cardType:
                type: "string"
              colorIndex:
                type: "integer"
              playerName:
                type: "string"
              selected:
                type: "boolean"
              value:
                type: "integer"
        currentRound:
          type: "string"
    ProbabilityResponse:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        playerResponse:
          type: "object"
          properties:
            colorIndex:
              type: "integer"
            isReady:
              type: "boolean"
            menuResponse:
              type: "object"
              properties:
                id:
                  type: "integer"
                menuType:
                  type: "string"
                  enum:
                    - "COFFEE"
                    - "ADE"
                    - "SMOOTHIE"
                    - "FRAPPUCCINO"
                    - "ETC"
                name:
                  type: "string"
            playerName:
              type: "string"
            playerType:
              type: "string"
              enum:
                - "HOST"
                - "GUEST"
        probability:
          type: "number"
    MiniGameMessage:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        commandRequest:
          type: "object"
        commandType:
          type: "string"
          enum:
            - "START_MINI_GAME"
            - "SELECT_CARD"
    RouletteSpinMessage:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        hostName:
          type: "string"
    MiniGameSelectMessage:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        hostName:
          type: "string"
        miniGameTypes:
          type: "array"
          items:
            type: "string"
            const: "CARD_GAME"
    MenuChangeMessage:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        menuId:
          type: "integer"
        playerName:
          type: "string"
    ReadyChangeMessage:
      $schema: "http://json-schema.org/draft-07/schema#"
      type: "object"
      properties:
        isReady:
          type: "boolean"
        joinCode:
          type: "string"
        playerName:
          type: "string"
